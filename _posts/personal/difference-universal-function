\section{Message Authentication Codes (MAC)}

Before presenting the elegant mathematics behind secure constructions, we introduce key cryptographic concepts where they arise.

\subsection*{Overview}

In general, \textbf{MACs} (Message Authentication Codes) are cryptographic tools used to ensure:

\begin{itemize}
  \item \textbf{Integrity:} the message was not altered in transit
  \item \textbf{Authenticity:} the message genuinely originated from the sender
\end{itemize}

The idea is simple: a MAC function takes a message and a secret key, and produces a short \textbf{tag}. This tag is then sent along with the message. Anyone with the secret key can verify whether the message and tag are consistent; without the key, it is infeasible to forge a valid tag.

\[
\text{Tag} = \mathrm{MAC}_k(m)
\]

Where:
\begin{itemize}
  \item \( m \): the message
  \item \( k \): the secret key
  \item \( \mathrm{MAC}_k \): the MAC function keyed with \( k \)
\end{itemize}

\subsection*{Key Definitions}

\paragraph{Pseudorandom Function (PRF).}  
A function that takes a truly random seed (e.g., a key) and stretches it to a longer output that is computationally indistinguishable from a truly random function.

\paragraph{\( \varepsilon \)-Difference-Universal Function.}  
A function \( f \) is \( \varepsilon \)-difference-universal if, for any distinct inputs \( x_1 \neq x_2 \) and any difference \( d \), the probability that:
\[
f(x_1) = f(x_2)
\]
is at most \( \varepsilon \).  
\textit{Key Idea:} the differences between outputs are nearly uniform — making them unpredictable.

\paragraph{Strongly Secure MAC.}  
A MAC scheme is strongly secure if it resists forgery even when an adversary can adaptively query the MAC oracle and later attempts to forge a new, valid message–tag pair.

\subsection*{A Strong MAC Scheme}

Let \( h \) be an \( \varepsilon \)-difference-universal function for negligible \( \varepsilon \), and let \( F \) be a pseudorandom function. Then the following construction defines a strongly secure MAC for messages in the domain \( \mathcal{M}_n \), where \( n \) is the security parameter:

\subsubsection*{Step 1 — Key Generation}

On input \( 1^n \), generate:
\begin{itemize}
  \item \( k_h \in \mathcal{K}_n \) — key for \( h \)
  \item \( k_F \in \{0,1\}^n \) — key for PRF
\end{itemize}

Output the key pair:
\[
k = (k_h, k_F)
\]

\subsubsection*{Step 2 — Tag Generation (\texttt{Mac})}

On input \( (k_h, k_F) \) and message \( m \in \mathcal{M}_n \), choose random \( r \in \{0,1\}^n \), then compute:
\[
t := \langle r,\; h_{k_h}(m) + F_{k_F}(r) \rangle
\]

\emph{Note:} The randomness in \( r \) and the PRF ensures unpredictability.

\subsubsection*{Step 3 — Verification (\texttt{Vrfy})}

On input \( (k_h, k_F) \), message \( m \), and tag \( t = \langle r, s \rangle \), output 1 if and only if:
\[
s = h_{k_h}(m) + F_{k_F}(r)
\]

\textit{The above constitutes a strongly secure MAC scheme.}

\section{Elegance: Algebraic Foundation of MACs}

We now shift gears into the abstract algebraic structures that allow us to elegantly construct \( \varepsilon \)-difference-universal functions.

\section*{Algebraic Structures}

\paragraph{Group.}  
A \textbf{group} is a set \( G \) with a binary operation \( \cdot \) satisfying:
\begin{itemize}
  \item \textbf{Closure:} \( a \cdot b \in G \) for all \( a, b \in G \)
  \item \textbf{Associativity:} \( (a \cdot b) \cdot c = a \cdot (b \cdot c) \)
  \item \textbf{Identity:} There exists \( e \in G \) such that \( a \cdot e = a \)
  \item \textbf{Inverses:} For every \( a \in G \), there exists \( a^{-1} \in G \) such that \( a \cdot a^{-1} = e \)
\end{itemize}

\textit{Examples:}
\begin{itemize}
  \item \( (\mathbb{Z}, +) \): Identity is 0; inverse of \( a \) is \( -a \)
  \item \( (\mathbb{R} \setminus \{0\}, \cdot) \): Identity is 1; inverse of \( a \) is \( 1/a \)
\end{itemize}

\paragraph{Abelian Group.}  
A group \( (G, +) \) is \textbf{abelian} if it satisfies:
\[
a + b = b + a
\]

\paragraph{Ring.}  
A \textbf{ring} is a set \( R \) equipped with operations \( (+, \cdot) \) such that:
\begin{itemize}
  \item \( (R, +) \) is an abelian group
  \item \( \cdot \) is associative
  \item \textbf{Distributivity:} \( a \cdot (b + c) = a \cdot b + a \cdot c \) and \( (a + b) \cdot c = a \cdot c + b \cdot c \)
\end{itemize}

\paragraph{Commutative Ring.}  
A ring \( R \) is \textbf{commutative} if:
\[
a \cdot b = b \cdot a \quad \text{for all } a, b \in R
\]

\paragraph{Field.}  
A \textbf{field} is a commutative ring \( F \) with \( 1 \neq 0 \) such that:
\[
\forall a \in F \setminus \{0\}, \quad \exists a^{-1} \in F \text{ such that } a \cdot a^{-1} = 1
\]

\paragraph{Finite Field.}  
A \textbf{finite field} (also called a \textbf{Galois field}) is a field with finitely many elements. Such fields exist only when the number of elements is a power of a prime:
\[
|\mathbb{F}| = p^n \quad \text{for some prime } p \text{ and integer } n \geq 1
\]
They are denoted \( \mathbb{F}_p \) or \( \mathrm{GF}(p^n) \).

